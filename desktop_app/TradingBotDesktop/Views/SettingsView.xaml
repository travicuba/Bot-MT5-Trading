<Page x:Class="TradingBotDesktop.Views.SettingsView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="{StaticResource SecondaryBgBrush}"
      Title="Conexion VPS">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="24" MaxWidth="700" HorizontalAlignment="Left">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0" Text="Conexion VPS" Style="{StaticResource PageTitle}"/>

            <!-- CONEXION VPS -->
            <Border Grid.Row="1" Style="{StaticResource CardPanel}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="SERVIDOR VPS" Style="{StaticResource SectionTitle}"/>

                    <Label Content="URL del servidor (incluir puerto)"/>
                    <TextBox x:Name="TxtVpsUrl"
                             Text="http://217.154.100.195:8080"
                             Margin="0,0,0,12"/>

                    <Label Content="API Key (obtenida al configurar el VPS)"/>
                    <TextBox x:Name="TxtApiKey" Margin="0,0,0,12"/>

                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                        <Button Content="Probar Conexion" Style="{StaticResource SecondaryButton}"
                                Click="BtnTest_Click" Margin="0,0,8,0"/>
                        <TextBlock x:Name="TestResult" Text="" VerticalAlignment="Center"
                                   FontSize="12"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- RUTA MT5 LOCAL -->
            <Border Grid.Row="2" Style="{StaticResource CardPanel}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="MT5 EN WINDOWS (PC Local)" Style="{StaticResource SectionTitle}"/>

                    <TextBlock TextWrapping="Wrap" Margin="0,0,0,12"
                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12">
                        Ruta a la carpeta "Files" del terminal MT5 instalado en esta PC.
                        Generalmente: C:\Users\[usuario]\AppData\Roaming\MetaQuotes\Terminal\[ID]\MQL5\Files
                    </TextBlock>

                    <Label Content="Carpeta Files de MT5"/>
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox x:Name="TxtMt5Path" Grid.Column="0" Margin="0,0,8,0"/>
                        <Button Grid.Column="1" Content="Buscar..."
                                Style="{StaticResource SecondaryButton}"
                                Click="BtnBrowseMt5_Click" Padding="12,8"/>
                    </Grid>

                    <CheckBox x:Name="ChkBridgeAutoStart"
                              Content="Iniciar puente MT5 automaticamente al abrir la app"
                              Margin="0,0,0,8"/>

                    <TextBlock TextWrapping="Wrap" FontSize="11"
                               Foreground="{StaticResource TextSecondaryBrush}">
                        El puente sincroniza archivos entre el bot Python (VPS) y el MT5 de tu PC:
                        se√±ales de trading, datos de mercado y feedback de trades.
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- OPCIONES UI + MANTENIMIENTO -->
            <Border Grid.Row="3" Style="{StaticResource CardPanel}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- UI Options -->
                    <StackPanel Grid.Column="0" Margin="0,0,16,0">
                        <TextBlock Text="OPCIONES DE INTERFAZ" Style="{StaticResource SectionTitle}"/>

                        <CheckBox x:Name="ChkAutoRefresh"
                                  Content="Actualizar automaticamente"
                                  Margin="0,0,0,8"/>

                        <Label Content="Intervalo de actualizacion (seg)"/>
                        <TextBox x:Name="TxtRefreshInterval" Width="80"
                                 HorizontalAlignment="Left" Margin="0,0,0,12"/>

                        <Button Content="Guardar Configuracion"
                                Style="{StaticResource PrimaryButton}"
                                Margin="0,8,0,0"
                                Click="BtnSave_Click"/>
                    </StackPanel>

                    <!-- Mantenimiento -->
                    <StackPanel Grid.Column="1" Margin="16,0,0,0">
                        <TextBlock Text="MODO MANTENIMIENTO" Style="{StaticResource SectionTitle}"/>

                        <TextBlock TextWrapping="Wrap" FontSize="12"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   Margin="0,0,0,12">
                            Activa el modo mantenimiento para bloquear el acceso a todos los usuarios.
                        </TextBlock>

                        <Label Content="Mensaje para usuarios"/>
                        <TextBox x:Name="TxtMaintenanceMsg"
                                 Text="Estamos realizando mejoras. Vuelva pronto."
                                 Margin="0,0,0,12"/>

                        <StackPanel Orientation="Horizontal">
                            <Button x:Name="BtnMaintenanceOn"
                                    Content="Activar Mantenimiento"
                                    Style="{StaticResource DangerButton}"
                                    Click="BtnMaintenanceOn_Click"
                                    Margin="0,0,8,0"/>
                            <Button x:Name="BtnMaintenanceOff"
                                    Content="Desactivar"
                                    Style="{StaticResource SuccessButton}"
                                    Click="BtnMaintenanceOff_Click"/>
                        </StackPanel>

                        <TextBlock x:Name="MaintenanceStatus" Text=""
                                   FontSize="11" Margin="0,8,0,0"
                                   Foreground="{StaticResource WarningBrush}"/>
                    </StackPanel>
                </Grid>
            </Border>

        </Grid>
    </ScrollViewer>
</Page>
